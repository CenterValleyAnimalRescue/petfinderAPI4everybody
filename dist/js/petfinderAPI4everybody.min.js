/*! petfinderAPI4everybody v2.1.0 | (c) 2015 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/petfinderAPI4everybody */
!function(e,t){"function"==typeof define&&define.amd?define([],t(e)):"object"==typeof exports?module.exports=t(e):e.petfinderAPI=t(e)}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";var t,n,o,a,i,r,s={},l="querySelector"in document&&"addEventListener"in e&&"classList"in document.createElement("_")&&"localStorage"in e,c={},p={},d={},u={},g={selector:{appMain:'[data-petfinder-app="main"]',appAside:'[data-petfinder-app="aside"]',templateAll:'[data-petfinder-template="all"]',templateOne:'[data-petfinder-template="one"]',templateAsideAll:'[data-petfinder-template="aside-all"]',templateAsideOne:'[data-petfinder-template="aside-one"]',async:"[data-petfinder-async]"},key:null,shelter:null,count:25,status:"A",offset:null,expiration:60,reverse:!1,initClass:"js-petfinder-api",allClass:"js-petfinder-api-all-pets",oneClass:"js-petfinder-api-one-pet",titlePrefix:"{{name}} | ",loading:"Fetching the latest pet info...",noPet:'Sorry, but this pet is no longer available. <a data-petfinder-async href="{{url.all}}">View available pets.</a>',classPrefix:"pf-",toggleAll:"Select/Unselect All",noImage:"",animalUnknown:"",breedDelimiter:", ",sizeUnknown:"Not Known",sizeS:"Small",sizeM:"Medium",sizeL:"Large",sizeXL:"Extra Large",ageUnknown:"Not Known",ageBaby:"Baby",ageYoung:"Young",ageAdult:"Adult",ageSenior:"Senior",genderUnknown:"Not Known",genderM:"Male",genderF:"Female",optionsSpecialNeeds:"Special Needs",optionsNoDogs:"No Dogs",optionsNoCats:"No Cats",optionsNoKids:"No Kids",optionsNoClaws:"No Claws",optionsHasShot:"Has hots",optionsHousebroken:"Housebroken",optionsAltered:"Spayed/Neutered",optionsNoDogsCatsKids:"No Dogs/Cats/Kids",optionsNoDogsCats:"No Dogs/Cats",optionsNoDogsKids:"No Dogs/Kids",optionsNoCatsKids:"No Cats/Kids",contactName:"",contactEmail:"",contactPhone:"",contactAddress1:"",contactAddress2:"",contactCity:"",contactState:"",contactZip:"",contactFax:"",callback:function(){}},m=function(e,t,n){if("[object Object]"===Object.prototype.toString.call(e))for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(n,e[o],o,e);else for(var a=0,i=e.length;i>a;a++)t.call(n,e[a],a,e)},f=function(){var e={},t=!1,n=0,o=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],n++);for(var a=function(n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t&&"[object Object]"===Object.prototype.toString.call(n[o])?e[o]=f(!0,e[o],n[o]):e[o]=n[o])};o>n;n++){var i=arguments[n];a(i)}return e},h=function(e,t){var n,o,a=t.charAt(0);for("["===a&&(t=t.substr(1,t.length-2),n=t.split("="),n.length>1&&(o=!0,n[1]=n[1].replace(/"/g,"").replace(/'/g,"")));e&&e!==document;e=e.parentNode){if("."===a&&e.classList.contains(t.substr(1)))return e;if("#"===a&&e.id===t.substr(1))return e;if("["===a&&e.hasAttribute(n[0])){if(!o)return e;if(e.getAttribute(n[0])===n[1])return e}if(e.tagName.toLowerCase()===t)return e}return null},b=function(e){var n="http://api.petfinder.com/shelter.getPets?format=json",o="";return o+="&key="+t.key,o+="&id="+t.shelter,o+="&count="+parseInt(t.count,10),o+="&status="+t.status,o+="&output=full",t.offset&&(o+="&offset="+parseInt(t.offset,10)),e&&(o+="&callback="+e),n+o},v=function(e){var t=window.document.getElementsByTagName("script")[0],n=window.document.createElement("script");n.src=e,t.parentNode.insertBefore(n,t),n.onload=function(){this.remove()}};s.setAPIData=function(e){if("100"!==e.petfinder.header.status.code.$t)return console.log("Unable to get data from Petfinder. Using expired localStorage data instead."),void q();var n=60*parseInt(t.expiration,10)*1e3;o={pets:e.petfinder.pets.pet,timestamp:(new Date).getTime()+n},localStorage.setItem(a,JSON.stringify(o)),q()};var y=function(){if(o=JSON.parse(localStorage.getItem(a)),o&&(new Date).getTime()<o.timestamp)return void q();var e=b("petfinderAPI.setAPIData");v(e)},k=function(e){var n=e?t.titlePrefix+u.title:u.title;n=n.replace(/\{\{name\}\}/,e),document.title=n},S=function(e,n,o){var a=o,i=function(t,n){e.options.option&&m(e.options.option,function(e){e.$t===t&&(a=n)})};if("description"===n&&(a=N(e.description.$t),a=$(a),a=z(a),a='<div style="white-space: pre-wrap;">'+a+"</div>"),"breeds"===n){if("[object Object]"===Object.prototype.toString.call(e.breeds.breed))return a=e.breeds.breed.$t;m(e.breeds.breed,function(e,n){a+=0===n?"":t.breedDelimiter,a+=e.$t})}if("size"===n&&("S"===e.size.$t&&(a=t.sizeS),"M"===e.size.$t&&(a=t.sizeM),"L"===e.size.$t&&(a=t.sizeL),"XL"===e.size.$t&&(a=t.sizeXL)),"age"===n&&("Baby"===e.age.$t&&(a=t.ageBaby),"Young"===e.age.$t&&(a=t.ageYoung),"Adult"===e.age.$t&&(a=t.ageAdult),"Senior"===e.age.$t&&(a=t.ageSenior)),"gender"===n&&("M"===e.sex.$t&&(a=t.genderM),"F"===e.sex.$t&&(a=t.genderF)),"multiOptions"===n){var r,s,l;if(!e.options.option)return;m(e.options.option,function(e){"noCats"===e.$t&&(r=!0),"noDogs"===e.$t&&(s=!0),"noKids"===e.$t&&(l=!0)}),r===!0&&s===!0&&l===!0&&(a=t.optionsNoDogsCatsKids),r===!0&&s===!0&&(a=t.optionsNoDogsCats),s===!0&&l===!0&&(a=t.optionsNoDogsKids),r===!0&&l===!0&&(a=t.optionsNoCatsKids),s===!0&&(a=t.optionsNoDogs),r===!0&&(a=t.optionsNoCats),l===!0&&(a=t.optionsNoKids)}return"specialNeeds"===n&&i("specialNeeds",t.optionsSpecialNeeds),"noDogs"===n&&i("noDogs",t.optionsNoDogs),"noCats"===n&&i("noCats",t.optionsNoCats),"noKids"===n&&i("noKids",t.optionsNoKids),"noClaws"===n&&i("noClaws",t.optionsNoClaws),"hasShot"===n&&i("hasShots",t.optionsHasShots),"housebroken"===n&&i("housebroken",t.optionsHousebroken),"altered"===n&&i("altered",t.optionsAltered),a},w=function(e,n,o){if(0===e.media.photos.photo.count)return"";var a,i=t.noImage;return"large"===n&&(a="x"),"medium"===n&&(a="pn"),"thumbSmall"===n&&(a="t"),"thumbMedium"===n&&(a="pnt"),"thumbLarge"===n&&(a="fpm"),m(e.media.photos.photo,function(e){return e["@size"]===a&&e["@id"]===o?void(i=e.$t):void 0}),i},x=function(e,n){var o="";return"name"===n&&(o=e.contact.name&&e.contact.name.$t?e.contact.name.$t:t.contactName),"email"===n&&(o=e.contact.email&&e.contact.email.$t?e.contact.email.$t:t.contactEmail),"phone"===n&&(o=e.contact.phone&&e.contact.phone.$t?e.contact.phone.$t:t.contactPhone),"address1"===n&&(o=e.contact.address1&&e.contact.address1.$t?e.contact.address1.$t:t.contactAddress1),"address2"===n&&(o=e.contact.address2&&e.contact.address2.$t?e.contact.address2.$t:t.contactAddress2),"city"===n&&(o=e.contact.city&&e.contact.city.$t?e.contact.city.$t:t.contactCity),"state"===n&&(o=e.contact.state&&e.contact.state.$t?e.contact.state.$t:t.contactState),"zip"===n&&(o=e.contact.zip&&e.contact.zip.$t?e.contact.zip.$t:t.contactZip),"fax"===n&&(o=e.contact.fax&&e.contact.fax.$t?e.contact.fax.$t:t.contactFax),o},$=function(e){return e&&""!==e?e.replace(/(http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?/g,'<a href="$&" rel="nofollow">$&</a>'):void 0},z=function(e){return e&&""!==e?e.replace(/([a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4})/g,'<a href="mailto:$&">$&</a>'):void 0},N=function(e){return e&&""!==e?e.replace(/<p><\/p>/g,"").replace(/<p> <\/p>/g,"").replace(/<p>&nbsp;<\/p>/g,"").replace(/&nbsp;/g,"").replace(/<span>/g,"").replace(/<\/span>/g,"").replace(/<font>/g,"").replace(/<\/font>/g,""):void 0},L=function(e,n){return e&&""!==e?(n&&(e=t.classPrefix+e),e.replace(/\(/g,"").replace(/\)/g,"").replace(/\&/g,"-").replace(/\//g,"-").replace(/ /g,"-").toLowerCase()):void 0},A=function(e){if("[object Object]"===Object.prototype.toString.call(e.breeds.breed))return" "+L(e.breeds.breed.$t,!0);var t="";return m(e.breeds.breed,function(e,n){t+=" "+L(e.$t,!0)}),t},C=function(e){return[t.classPrefix+"pet",L(S(e,"age",t.ageUnknown),!0),L(e.animal.$t,!0),A(e),L(S(e,"specialNeeds",""),!0),L(S(e,"noDogs",""),!0),L(S(e,"noCats",""),!0),L(S(e,"noKids",""),!0),L(S(e,"noClaws",""),!0),L(S(e,"hasShots",""),!0),L(S(e,"housebroken",""),!0),L(S(e,"altered",""),!0),L(S(e,"gender",t.genderUnknown),!0),L(S(e,"size",t.sizeUnknown),!0)].join(" ")},D=function(e,n){if(d[e])return d[e];var a=[],i=[];return m(o.pets,function(o){var i=S(o,e,n);if("breeds"===e){var r=i.split(t.breedDelimiter);return void m(r,function(e){-1===a.indexOf(e)&&a.push(e)})}-1===a.indexOf(i)&&a.push(i)}),a.sort(),"size"===e&&(-1!==a.indexOf(t.sizeS)&&i.push(t.sizeS),-1!==a.indexOf(t.sizeM)&&i.push(t.sizeM),-1!==a.indexOf(t.sizeL)&&i.push(t.sizeL),-1!==a.indexOf(t.sizeXL)&&i.push(t.sizeXL),a=i),"age"===e&&(-1!==a.indexOf(t.ageBaby)&&i.push(t.ageBaby),-1!==a.indexOf(t.ageYoung)&&i.push(t.ageYoung),-1!==a.indexOf(t.ageAdult)&&i.push(t.ageAdult),-1!==a.indexOf(t.ageSenior)&&i.push(t.ageSenior),a=i),d[e]=a,a},O=function(e,t){var n="",o=D(e,t);return m(o,function(e){n+="<li>"+e+"</li>"}),n},P=function(e,n,o){var a="",i="",r="breeds"===e?"breeds":"attributes",s=D(e,n);return m(s,function(t){var n=L(t,!0);a+='<label><input type="checkbox" data-petfinder-sort="'+r+'" data-petfinder-sort-type="'+e+'" data-petfinder-sort-target=".'+n+'" checked>'+t+"</label>"}),o&&(i='<label><input type="checkbox" data-petfinder-sort="toggle" data-petfinder-sort-target="[data-petfinder-sort-type='+e+']" checked>'+t.toggleAll+"</label>"),i+a},M=function(){var e=document.querySelector(t.selector.templateAll),n=document.querySelector(t.selector.templateOne),o=document.querySelector(t.selector.templateAsideAll),a=document.querySelector(t.selector.templateAsideOne);e&&(c.allPets=e.innerHTML),n&&(c.onePet=n.innerHTML),o&&(c.asideAllPets=o.innerHTML),a&&(c.asideOnePet=a.innerHTML)},U=function(e,n,o){return e?n.replace(/\{\{name\}\}/g,e.name.$t).replace(/\{\{id\}\}/g,e.id.$t).replace(/\{\{animal\}\}/,e.animal.$t).replace(/\{\{age\}\}/,S(e,"age",t.ageUnknown)).replace(/\{\{gender\}\}/,S(e,"gender",t.genderUnknown)).replace(/\{\{size\}\}/,S(e,"size",t.sizeUnknown)).replace(/\{\{breeds\}\}/,S(e,"breeds","")).replace(/\{\{description\}\}/,S(e,"description","")).replace(/\{\{photo.1.large\}\}/g,w(e,"large","1")).replace(/\{\{photo.2.large\}\}/g,w(e,"large","2")).replace(/\{\{photo.3.large\}\}/g,w(e,"large","3")).replace(/\{\{photo.1.medium\}\}/g,w(e,"medium","1")).replace(/\{\{photo.2.medium\}\}/g,w(e,"medium","2")).replace(/\{\{photo.3.medium\}\}/g,w(e,"medium","3")).replace(/\{\{photo.1.thumbnail.small\}\}/g,w(e,"thumbSmall","1")).replace(/\{\{photo.2.thumbnail.small\}\}/g,w(e,"thumbSmall","2")).replace(/\{\{photo.3.thumbnail.small\}\}/g,w(e,"thumbSmall","3")).replace(/\{\{photo.1.thumbnail.medium\}\}/g,w(e,"thumbMedium","1")).replace(/\{\{photo.2.thumbnail.medium\}\}/g,w(e,"thumbMedium","2")).replace(/\{\{photo.3.thumbnail.medium\}\}/g,w(e,"thumbMedium","3")).replace(/\{\{photo.1.thumbnail.large\}\}/g,w(e,"thumbLarge","1")).replace(/\{\{photo.2.thumbnail.large\}\}/g,w(e,"thumbLarge","2")).replace(/\{\{photo.3.thumbnail.large\}\}/g,w(e,"thumbLarge","3")).replace(/\{\{options.multi\}\}/,S(e,"multiOptions","")).replace(/\{\{options.specialNeeds\}\}/,S(e,"specialNeeds","")).replace(/\{\{options.noDogs\}\}/,S(e,"noDogs","")).replace(/\{\{options.noCats\}\}/,S(e,"noCats","")).replace(/\{\{options.noKids\}\}/,S(e,"noKids","")).replace(/\{\{options.noClaws\}\}/,S(e,"noClaws","")).replace(/\{\{options.hasShots\}\}/,S(e,"hasShots","")).replace(/\{\{options.housebroken\}\}/,S(e,"housebroken","")).replace(/\{\{options.altered\}\}/,S(e,"altered","")).replace(/\{\{contact.name\}\}/,x(e,"name")).replace(/\{\{contact.email\}\}/,x(e,"email")).replace(/\{\{contact.phone\}\}/,x(e,"phone")).replace(/\{\{contact.address1\}\}/,x(e,"address1")).replace(/\{\{contact.address2\}\}/,x(e,"address2")).replace(/\{\{contact.city\}\}/,x(e,"city")).replace(/\{\{contact.state\}\}/,x(e,"state")).replace(/\{\{contact.zip\}\}/,x(e,"zip")).replace(/\{\{contact.fax\}\}/,x(e,"fax")).replace(/\{\{url.all\}\}/g,i).replace(/\{\{url.pet\}\}/g,i+"?petID="+e.id.$t).replace(/\{\{url.petfinder\}\}/g,"https://www.petfinder.com/petdetail/"+e.id.$t).replace(/\{\{classes\}\}/,C(e)).replace(/\{\{number\}\}/g,o).replace(/\{\{total\}\}/g,r):n.replace(/\{\{list.ages\}\}/,O("age",t.ageUnknown)).replace(/\{\{list.animals\}\}/,O("animal",t.animalUnknown)).replace(/\{\{list.breeds\}\}/,O("breeds","","breed")).replace(/\{\{list.options\}\}/,O("options","","option")).replace(/\{\{list.genders\}\}/,O("sex",t.genderUnknown)).replace(/\{\{list.sizes\}\}/,O("size",t.sizeUnknown)).replace(/\{\{checkbox.ages\}\}/,P("age",t.ageUnknown)).replace(/\{\{checkbox.animals\}\}/,P("animal",t.animalUnknown)).replace(/\{\{checkbox.breeds\}\}/,P("breeds","")).replace(/\{\{checkbox.options\}\}/,P("options","")).replace(/\{\{checkbox.genders\}\}/,P("gender",t.genderUnknown)).replace(/\{\{checkbox.sizes\}\}/,P("size",t.sizeUnknown)).replace(/\{\{checkbox.ages.toggle\}\}/,P("age",t.ageUnknown,!0)).replace(/\{\{checkbox.animals.toggle\}\}/,P("animal",t.animalUnknown,!0)).replace(/\{\{checkbox.breeds.toggle\}\}/,P("breeds","",!0)).replace(/\{\{checkbox.options.toggle\}\}/,P("options","",!0)).replace(/\{\{checkbox.genders.toggle\}\}/,P("gender",t.genderUnknown,!0)).replace(/\{\{checkbox.sizes.toggle\}\}/,P("size",t.sizeUnknown,!0)).replace(/\{\{total\}\}/g,r)},j=function(e){history.pushState&&history.pushState(null,null,e)},K=function(e){var t={};return m(o.pets,function(n,o){n.id.$t===e&&(t.pet=n,t.number=o.toString())}),t},I=function(e){if(p.aside){var t=e?U(null,e):"";p.aside.innerHTML=t}},H=function(){var e="";m(o.pets,function(t,n){e+=U(t,c.allPets,n)}),p.main.innerHTML=e,k(),document.documentElement.classList.add(t.allClass),document.documentElement.classList.remove(t.oneClass)},E=function(e){var n=K(e);if(!n.pet||!n.number)return void(p.main.innerHTML=t.noPet.replace(/\{\{url.all\}\}/,i));var o=U(n.pet,c.onePet,n.number);p.main.innerHTML=o,k(n.pet.name.$t),document.documentElement.classList.add(t.oneClass),document.documentElement.classList.remove(t.allClass)},T=function(){t.loading&&(p.main.innerHTML=t.loading)},B=function(n,o){return e.scrollTo(0,0),n?(E(n[1]),I(c.asideOnePet),o&&j(i+"?petID="+n[1]),void t.callback()):(H(),I(c.asideAllPets),o&&j(i),void t.callbackAfter())},q=function(){if(!o)return p.main.innerHTML=u.content,void console.log("Unable to retrieve Petfinder data from the API or localStorage.");t.reverse&&o.reverse(),r=o.pets.length;var n=/[\\?&]petID=([^&#]*)/i.exec(e.location.href);B(n,!0)},F=function(e){if(history.pushState){var n=e.target;new RegExp(i);if(h(n,t.selector.async)){e.preventDefault();var o=/[\\?&]petID=([^&#]*)/i.exec(n);B(o,!0)}}},Y=function(t){if(history.pushState){var n=/[\\?&]petID=([^&#]*)/i.exec(e.location.href);B(n)}};return s.destroy=function(){t&&(document.documentElement.classList.remove(t.initClass),document.documentElement.classList.remove(t.allClass),document.documentElement.classList.remove(t.oneClass),p.main&&u.content&&(p.main.innerHTML=u.content),p.aside&&(p.aside.innerHTML=""),u.title&&(document.title=u.title),document.removeEventListener("click",F,!1),c={},p={},d={},u={},t=null,n=null,o=null,a=null,i=null,r=null)},s.init=function(n){if(l){if(s.destroy(),t=f(g,n||{}),!t.key||!t.shelter)return void console.log("You must provide a Petfinder API key and shelter ID to use petfinderAPI4everybody.js");document.documentElement.classList.add(t.initClass),a=[t.key,t.shelter,t.count,t.status,t.offset].join(""),p.main=document.querySelector('[data-petfinder-app="main"]'),p.aside=document.querySelector('[data-petfinder-app="aside"]'),u.content=p.main.innerHTML,u.title=document.title,i=[e.location.protocol,"//",e.location.host,e.location.pathname].join(""),M(),T(),y(),document.addEventListener("click",F,!1),e.onpopstate=Y}},s});